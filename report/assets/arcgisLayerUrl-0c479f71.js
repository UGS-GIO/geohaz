import{I as i,q as a,S as c,V as h,x as w,a as y}from"./request-a10d6950.js";import{f as S}from"./persistableUrlUtils-ca6bb38d.js";const f={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer"},v=Object.values(f),p=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${v.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),g=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${v.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),C=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function $(e){return!!p.test(e)}function d(e){if(e==null)return null;const r=i(e),t=(r==null?void 0:r.path.match(p))||(r==null?void 0:r.path.match(g));if(!t)return null;const[,n,s,l,u]=t,o=s.indexOf("/");return{title:m(o!==-1?s.slice(o+1):s),serverType:f[l.toLowerCase()],sublayer:u!=null&&u!==""?parseInt(u,10):null,url:{path:n}}}function I(e){const r=i(e).path.match(C);return r?{serviceUrl:r[1],sublayerId:Number(r[2])}:null}function m(e){return(e=e.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function x(e,r){const t=[];if(e){const n=d(e);n!=null&&n.title&&t.push(n.title)}if(r){const n=m(r);t.push(n)}if(t.length===2){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")}function j(e){if(!e)return!1;const r=".arcgis.com/",t="//services",n="//tiles",s="//features",l=(e=e.toLowerCase()).includes(r),u=e.includes(t)||e.includes(n)||e.includes(s);return l&&u}function U(e,r){return e&&a(c(e,r))}function T(e){let{url:r}=e;if(!r)return{url:r};r=c(r,e.logger);const t=i(r),n=d(t.path);let s;if(n!=null)n.sublayer!=null&&e.layer.layerId==null&&(s=n.sublayer),r=n.url.path;else if(e.nonStandardUrlAllowed){const l=I(t.path);l!=null&&(r=l.serviceUrl,s=l.sublayerId)}return{url:a(r),layerId:s}}function V(e,r,t,n,s){S(r,n,"url",s),n.url&&e.layerId!=null&&(n.url=h(n.url,t,e.layerId.toString()))}function q(e){if(!e)return!1;const r=e.toLowerCase(),t=r.includes("/services/"),n=r.includes("/mapserver/wmsserver"),s=r.includes("/imageserver/wmsserver"),l=r.includes("/wmsserver");return t&&(n||s||l)}function A(e){var n;if(!e)return!1;const r=new w(y(e)),t=(n=r.authority)==null?void 0:n.toLowerCase();return t==="server.arcgisonline.com"||t==="services.arcgisonline.com"}export{q as C,V as S,A as b,I as d,T as g,x as h,m,d as p,$ as v,j as w,U as y};
