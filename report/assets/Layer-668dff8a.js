import{_ as s,I as h,U as c}from"./request-a10d6950.js";import{e as r,c as b}from"./subclass-f7409b1b.js";import"./geometry-31b45acd.js";import{c as f,s as p,a as v}from"./Error-21d1d076.js";import{o as g}from"./Evented-b5127116.js";import{s as _}from"./Identifiable-1430bdc2.js";import{m as E}from"./Loadable-8a1ead8b.js";import{b as w}from"./promiseUtils-1d963c7c.js";import{y as o}from"./JSONSupport-acf2865c.js";import"./typedArrayUtil-2af43698.js";import{M as y}from"./Extent-2b4578b8.js";import{f as n}from"./SpatialReference-428523ee.js";async function L(t){const i="portalItem"in t?t:{portalItem:t},{fromItem:d}=await s(()=>import("./portalLayers-4474e209.js").then(l=>l.p),["./portalLayers-4474e209.js","./Error-21d1d076.js","./typedArrayUtil-2af43698.js","./associatedFeatureServiceUtils-c7af6fe2.js","./request-a10d6950.js","./JSONSupport-acf2865c.js","./subclass-f7409b1b.js","./promiseUtils-1d963c7c.js","./time-0817624a.js","./arcgisLayerUrl-0c479f71.js","./persistableUrlUtils-ca6bb38d.js","./Portal-cb507469.js","./Loadable-8a1ead8b.js","./Promise-ec74e14b.js","./Extent-2b4578b8.js","./SpatialReference-428523ee.js","./jsonMap-5ba4a9c2.js","./assets-6fd92e57.js","./cast-e7a2f9aa.js","./locale-bde6d0f6.js","./PortalItem-9d3416e3.js","./requestPresets-cacb0d18.js","./layerUtils-c805b05c.js","./lazyLayerLoader-b21a171b.js","./portalItemUtils-8aceb0b8.js","./projection-41da473c.js","./SimpleObservable-ae589a25.js","./mathUtils-19b6edfc.js","./Polyline-013cde1f.js","./aaBoundingRect-aef00841.js","./Axis-30be7e73.js","./projectBuffer-af7b4ad9.js","./zscale-d7e12601.js"],import.meta.url);try{return await d(i)}catch(l){const a=i&&i.portalItem,u=(a==null?void 0:a.id)||"unset",m=a&&a.portal&&a.portal.url||f.portalUrl;throw p.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+m+"', id: '"+u+"')",l),l}}let D=0,e=class extends g.EventedMixin(_(E)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new y(-180,-90,180,90,n.WGS84),this.id=Date.now().toString(16)+"-layer-"+D++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=n.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(t){const i=typeof t=="string"?{url:t}:t;return(await s(()=>import("./arcgisLayers-9d982e72.js"),["./arcgisLayers-9d982e72.js","./request-a10d6950.js","./Error-21d1d076.js","./typedArrayUtil-2af43698.js","./JSONSupport-acf2865c.js","./subclass-f7409b1b.js","./promiseUtils-1d963c7c.js","./time-0817624a.js","./arcgisLayerUrl-0c479f71.js","./persistableUrlUtils-ca6bb38d.js","./associatedFeatureServiceUtils-c7af6fe2.js","./Portal-cb507469.js","./Loadable-8a1ead8b.js","./Promise-ec74e14b.js","./Extent-2b4578b8.js","./SpatialReference-428523ee.js","./jsonMap-5ba4a9c2.js","./assets-6fd92e57.js","./cast-e7a2f9aa.js","./locale-bde6d0f6.js","./PortalItem-9d3416e3.js","./fetchService-b7ffffb9.js","./requestPresets-cacb0d18.js","./layerUtils-c805b05c.js","./lazyLayerLoader-b21a171b.js"],import.meta.url)).fromUrl(i)}static fromPortalItem(t){return L(t)}initialize(){this.when().catch(t=>{w(t)||p.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})})}destroy(){const t=this.parent;if(t){const i=this;"layers"in t&&t.layers.includes(i)?t.layers.remove(i):"tables"in t&&t.tables.includes(i)?t.tables.remove(i):"baseLayers"in t&&t.baseLayers.includes(i)?t.baseLayers.remove(i):"referenceLayers"in t&&t.referenceLayers.includes(i)&&t.referenceLayers.remove(i),this._set("parent",null)}}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return h(this.url)}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t)return(await c(t,{query:{f:"json"},responseType:"json"})).data;throw new v("layer:no-attribution-data","Layer does not have attribution data")}};r([o({type:String})],e.prototype,"attributionDataUrl",void 0),r([o({type:y})],e.prototype,"fullExtent",void 0),r([o({readOnly:!0})],e.prototype,"hasAttributionData",null),r([o({type:String,clonable:!1})],e.prototype,"id",void 0),r([o({type:Boolean,nonNullable:!0})],e.prototype,"legendEnabled",void 0),r([o({type:["show","hide","hide-children"]})],e.prototype,"listMode",void 0),r([o({type:Number,range:{min:0,max:1},nonNullable:!0})],e.prototype,"opacity",void 0),r([o({clonable:!1})],e.prototype,"parent",void 0),r([o({readOnly:!0})],e.prototype,"parsedUrl",null),r([o({type:Boolean,readOnly:!0})],e.prototype,"persistenceEnabled",void 0),r([o({type:Boolean})],e.prototype,"popupEnabled",void 0),r([o({type:Boolean})],e.prototype,"attributionVisible",void 0),r([o({type:n})],e.prototype,"spatialReference",void 0),r([o({type:String})],e.prototype,"title",void 0),r([o({readOnly:!0,json:{read:!1}})],e.prototype,"type",void 0),r([o()],e.prototype,"url",void 0),r([o({type:Boolean,nonNullable:!0})],e.prototype,"visible",void 0),e=r([b("esri.layers.Layer")],e);const V=e;export{V as b};
