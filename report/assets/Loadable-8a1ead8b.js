import{e as l,s as f,c}from"./subclass-f7409b1b.js";import{a as h}from"./Error-21d1d076.js";import{w as g,d as C}from"./promiseUtils-1d963c7c.js";import{m as b}from"./Promise-ec74e14b.js";import{y as r}from"./JSONSupport-acf2865c.js";const w="not-loaded",S="loading",E="failed",u="loaded",p=e=>{let t=class extends e{constructor(...o){super(...o),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(a=>{const m=this.load.bind(this);this.load=_=>{const y=new Promise((n,d)=>{const i=g(_,d);this.destroyed&&d(new h("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(n,d).finally(()=>{i&&i.remove()})});if(this.loadStatus===w){this._set("loadStatus",S);const n=this._loadController=new AbortController;m({signal:n.signal})}return a(),y}})),this.when(()=>{this._set("loadStatus",u),this._loadController=null},a=>{this._set("loadStatus",E),this._set("loadError",a),this._loadController=null})}destroy(){this._loadController&&(this._loadController=C(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===u}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var o;return this.isFulfilled()||(this._set("loadError",new h("load:cancelled","Cancelled")),(o=this._loadController)==null||o.abort(),this._promiseProps.abort()),this}};return l([r({readOnly:!0})],t.prototype,"loaded",null),l([r({readOnly:!0})],t.prototype,"loadError",void 0),l([r({clonable:!1})],t.prototype,"loadStatus",void 0),l([r({type:[f],readOnly:!0})],t.prototype,"loadWarnings",null),t=l([c("esri.core.Loadable")],t),t};let s=class extends p(b){};s=l([c("esri.core.Loadable")],s),function(e){function t(o){return!(!o||!o.load)}e.LoadableMixin=p,e.isLoadable=t}(s||(s={}));const x=s;export{x as m};
