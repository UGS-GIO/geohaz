import"./typedArrayUtil-2af43698.js";import{M as W}from"./mathUtils-19b6edfc.js";import{M as A}from"./Extent-2b4578b8.js";import{j as R}from"./Polyline-013cde1f.js";import{f as g,c as w}from"./SpatialReference-428523ee.js";import{K as v}from"./featureConversionUtils-e62978d0.js";import{e as B}from"./OptimizedGeometry-5ad221bf.js";import{j as b}from"./timeSupport-57e57e41.js";const F=new Float64Array(2),T=new Float64Array(2),Y="0123456789bcdefghjkmnpqrstuvwxyz",k=64;function N(n,e,o,f){const r=[n.xmin,n.ymin,n.xmax,n.ymax],a=R.fromExtent(A.fromBounds(r,f)),i=b(a,f,g.WGS84,{densificationStep:e*k});if(!i)return null;const t=v(new B,i,!1,!1),u=t.coords.filter((j,h)=>!(h%2)),c=t.coords.filter((j,h)=>h%2),d=Math.min(...u),p=Math.min(...c),m=Math.max(...u),l=Math.max(...c),s=G(d,p,o,g.WGS84),y=G(m,l,o,g.WGS84);return s&&y?{bounds:r,geohashBounds:{xLL:s[0],yLL:s[1],xTR:y[0],yTR:y[1]},level:o}:null}function G(n,e,o,f){if(f.isWebMercator){const i=W(n/w.radius),t=i-360*Math.floor((i+180)/360),u=[0,0];return $(u,0,W(Math.PI/2-2*Math.atan(Math.exp(-e/w.radius))),t,o),u}const r=b({x:n,y:e},f,g.WGS84);if(!r)return null;const a=[0,0];return $(a,0,r.y,r.x,o),a}function q(n){return Y[n]}function z(n){return(n[0]+n[1])/2}function L(n,e,o){return n[0]=e,n[1]=o,n}function C(n,e){const o=z(n),f=e,r=!e;n[0]=r*n[0]+f*o,n[1]=r*o+f*n[1]}function M(n,e){const o=e>z(n);return C(n,o),o}function O(n,e){let o=-90,f=90,r=-180,a=180;for(let i=0;i<e;i++){const t=Math.ceil((i+1)/2),u=Math.floor((i+1)/2),c=1-i%2,d=30-(3*t+2*u),p=30-(2*t+3*u),m=3*c+2*(1-c),l=2*c+3*(1-c),s=3*c+7*(1-c)<<p,y=(7*c+3*(1-c)<<d&n.geohashX)>>d,j=(s&n.geohashY)>>p;for(let h=m-1;h>=0;h--){const S=(r+a)/2,x=y&1<<h?1:0;r=(1-x)*r+x*S,a=(1-x)*S+x*a}for(let h=l-1;h>=0;h--){const S=(o+f)/2,x=j&1<<h?1:0;o=(1-x)*o+x*S,f=(1-x)*S+x*f}}return[r,o,a,f]}function $(n,e,o,f,r){r%2&&(r+=1);let a=0,i=0,t=-90,u=90,c=-180,d=180;for(let p=0;p<r/2;p++){for(let m=0;m<5;m++){const l=(c+d)/2,s=f>l?1:0;a|=s<<29-(m+5*p),c=(1-s)*c+s*l,d=(1-s)*l+s*d}for(let m=0;m<5;m++){const l=(t+u)/2,s=o>l?1:0;i|=s<<29-(m+5*p),t=(1-s)*t+s*l,u=(1-s)*l+s*u}}n[2*e]=a,n[2*e+1]=i}function Q(n,e,o){let f="";const r=L(F,-90,90),a=L(T,-180,180);for(let i=0;i<o;i++){let t=0;i%2?(t|=M(r,n)<<4,t|=M(a,e)<<3,t|=M(r,n)<<2,t|=M(a,e)<<1,t|=M(r,n)<<0):(t|=M(a,e)<<4,t|=M(r,n)<<3,t|=M(a,e)<<2,t|=M(r,n)<<1,t|=M(a,e)<<0),f+=q(t)}return f}export{G as A,O as R,N as S,Q as z};
