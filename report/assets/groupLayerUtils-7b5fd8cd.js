import{$ as l,j as y}from"./utils-df330680.js";import{o as f}from"./jsonContext-70ccb9b3.js";import{s as v,a as d,f as m,i as I}from"./portalItemUtils-8aceb0b8.js";import{p as a}from"./resourceUtils-1b55d47f.js";import"./Error-21d1d076.js";import"./typedArrayUtil-2af43698.js";import"./originUtils-cfe4feaf.js";import"./multiOriginJSONSupportUtils-c978f4c3.js";import"./Portal-cb507469.js";import"./request-a10d6950.js";import"./JSONSupport-acf2865c.js";import"./subclass-f7409b1b.js";import"./promiseUtils-1d963c7c.js";import"./time-0817624a.js";import"./Loadable-8a1ead8b.js";import"./Promise-ec74e14b.js";import"./Extent-2b4578b8.js";import"./SpatialReference-428523ee.js";import"./jsonMap-5ba4a9c2.js";import"./assets-6fd92e57.js";import"./cast-e7a2f9aa.js";import"./locale-bde6d0f6.js";import"./PortalItem-9d3416e3.js";import"./persistableUrlUtils-ca6bb38d.js";import"./saveAPIKeyUtils-7fbece8f.js";import"./saveUtils-534df74b.js";import"./projection-41da473c.js";import"./SimpleObservable-ae589a25.js";import"./mathUtils-19b6edfc.js";import"./Polyline-013cde1f.js";import"./aaBoundingRect-aef00841.js";import"./Axis-30be7e73.js";import"./projectBuffer-af7b4ad9.js";import"./zscale-d7e12601.js";import"./uuid-709b6c67.js";import"./resourceUtils-09076ff8.js";const p="Group Layer",g="group-layer-save",A="group-layer-save-as",i=m.GROUP_LAYER_MAP;function s(r){return{isValid:r.type==="group",errorMessage:"Layer.type should be 'group'"}}function P(r){return{isValid:v(r,i),errorMessage:`Layer.portalItem.typeKeywords should have '${i}'`}}function n(r,e){return{...f(r,"web-map",!0),initiator:e}}function c(r){const e=r.layerJSON;return Promise.resolve(e&&Object.keys(e).length?e:null)}async function R(r,e){e.title||(e.title=r.title),d(e,m.METADATA),I(e,i)}async function ir(r,e){return l({layer:r,itemType:p,validateLayer:s,validateItem:P,createJSONContext:t=>n(t,r),createItemData:c,errorNamePrefix:g,saveResources:async(t,o)=>(r.sourceIsPortalItem||await t.removeAllResources().catch(()=>{}),a(r.resourceReferences,o))},e)}async function mr(r,e,t){return y({layer:r,itemType:p,validateLayer:s,createJSONContext:o=>n(o,r),createItemData:c,errorNamePrefix:A,newItem:e,setItemProperties:R,saveResources:(o,u)=>a(r.resourceReferences,u)},t)}export{ir as save,mr as saveAs};
